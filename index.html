<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VENTE VEHICULE - Vitrine</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #fdf6f0;
    }
    header {
      background-color: #a47148;
      color: white;
      text-align: center;
      padding: 1rem;
    }
    .slider {
      max-width: 600px;
      margin: 2rem auto;
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      background: #ddd;
    }
    .slides {
      display: flex;
      transition: transform 0.5s ease-in-out;
      width: 100%;
    }
    .slides img {
      width: 100%;
      height: 300px;
      object-fit: cover;
      flex-shrink: 0;
      display: block;
    }
    .caption {
      text-align: center;
      margin-top: 1rem;
      font-size: 1.1rem;
    }
    .nav-buttons {
      position: absolute;
      top: 50%;
      width: 100%;
      display: flex;
      justify-content: space-between;
      transform: translateY(-50%);
    }
    .nav-buttons button {
      background: rgba(255,255,255,0.7);
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0 1rem;
      user-select: none;
    }
    .products {
      width: 90%;
      max-width: 800px;
      margin: auto;
    }
    .product {
      background: #fff;
      border: 1px solid #ddd;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }
    .product img {
      width: 120px;
      height: 80px;
      object-fit: cover;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .product-info {
      flex-grow: 1;
      font-weight: bold;
    }
    footer {
      background: #eee;
      text-align: center;
      padding: 1rem;
      margin-top: 2rem;
      font-size: 0.9rem;
    }
    button {
      margin-left: 0.5rem;
      cursor: pointer;
    }
    form {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }
    form input[type="text"] {
      flex-grow: 1;
      padding: 0.5rem;
      font-size: 1rem;
    }
    form input[type="file"] {
      padding: 0.2rem;
    }
    .admin-only {
      display: none;
    }
    #loginBox {
      text-align: center;
      margin: 2rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>Vente et location de véhicule</h1>
  </header>

  <div id="loginBox">
    <input type="password" id="adminPass" placeholder="Mot de passe admin" />
    <button onclick="checkLogin()">Connexion</button>
  </div>

  <section class="slider">
    <div class="slides" id="slideTrack"></div>
    <div class="nav-buttons">
      <button onclick="prevSlide()">⟨</button>
      <button onclick="nextSlide()">⟩</button>
    </div>
    <div class="caption" id="slideCaption"></div>
  </section>

  <section class="products">
    <!-- Remplace uniquement le <form> dans la section .products -->
<form id="productForm" class="admin-only" enctype="multipart/form-data">
  <h2>Ajouter un produit</h2>
  <input type="text" id="productName" placeholder="Nom du produit" required />
  <textarea id="productDesc" placeholder="Description du véhicule" rows="2" style="flex-grow:1;resize:none" required></textarea>
  <input type="file" id="productImage" accept="image/*" required />
  <button type="submit">Ajouter</button>
</form>
    <div id="productList"></div>
  </section>

  <footer>
    <p>Contact : ABD MADJID - ABDMADJID@VENTEVEHICULE.fr - 06 12 34 56 78</p>
    <p>Adresse : 12 rue du Thé, 75000 Paris</p>
  </footer>
<script>
  let isAdmin = false;
  let products = []; // { name, description, image }

  function checkLogin() {
    const pass = document.getElementById("adminPass").value;
    if (pass === "admin123") {
      isAdmin = true;
      document.getElementById("productForm").classList.remove("admin-only");
      document.getElementById("loginBox").style.display = "none";
      loadProducts();
    } else {
      alert("Mot de passe incorrect.");
    }
  }

  const form = document.getElementById("productForm");
  const productList = document.getElementById("productList");
  const slideTrack = document.getElementById("slideTrack");
  const slideCaption = document.getElementById("slideCaption");

  form.addEventListener("submit", function (e) {
    e.preventDefault();
    const name = document.getElementById("productName").value.trim();
    const description = document.getElementById("productDesc").value.trim();
    const fileInput = document.getElementById("productImage");
    if (!name || !description || !fileInput.files.length) return alert("Veuillez remplir tous les champs");

    const file = fileInput.files[0];
    const reader = new FileReader();
    reader.onload = function (event) {
      const imageBase64 = event.target.result;
      products.push({ name, description, image: imageBase64 });
      saveProducts();
      renderProducts();
      renderSlider();
      form.reset();
    };
    reader.readAsDataURL(file);
  });

  function createProductElement(product, index) {
    const div = document.createElement("div");
    div.className = "product";

    const img = document.createElement("img");
    img.src = product.image;
    img.alt = product.name;

    const info = document.createElement("div");
    info.className = "product-info";

    const title = document.createElement("strong");
    title.textContent = product.name;

    const desc = document.createElement("p");
    desc.textContent = product.description;
    desc.style.margin = "4px 0 0";

    info.appendChild(title);
    info.appendChild(desc);

    div.appendChild(img);
    div.appendChild(info);

    if (isAdmin) {
      const editBtn = document.createElement("button");
      editBtn.textContent = "Modifier";
      editBtn.onclick = () => editProduct(index);

      const delBtn = document.createElement("button");
      delBtn.textContent = "Supprimer";
      delBtn.onclick = () => {
        if (confirm("Voulez-vous vraiment supprimer ce produit ?")) {
          products.splice(index, 1);
          saveProducts();
          renderProducts();
          renderSlider();
        }
      };

      div.appendChild(editBtn);
      div.appendChild(delBtn);
    }

    return div;
  }

  function editProduct(index) {
    const product = products[index];
    const newName = prompt("Nouveau nom du produit :", product.name);
    if (newName === null) return;

    const newDesc = prompt("Nouvelle description :", product.description);
    if (newDesc === null) return;

    const fileInput = document.createElement("input");
    fileInput.type = "file";
    fileInput.accept = "image/*";
    fileInput.onchange = () => {
      if (fileInput.files.length) {
        const reader = new FileReader();
        reader.onload = (e) => {
          products[index] = {
            name: newName.trim() || product.name,
            description: newDesc.trim() || product.description,
            image: e.target.result,
          };
          saveProducts();
          renderProducts();
          renderSlider();
        };
        reader.readAsDataURL(fileInput.files[0]);
      } else {
        products[index].name = newName.trim() || product.name;
        products[index].description = newDesc.trim() || product.description;
        saveProducts();
        renderProducts();
        renderSlider();
      }
    };
    fileInput.click();
  }

  function saveProducts() {
    localStorage.setItem("products", JSON.stringify(products));
  }

  function loadProducts() {
    const saved = localStorage.getItem("products");
    if (saved) {
      products = JSON.parse(saved);
    } else {
      products = [
        {
          name: "Voiture 1 boîte manuelle",
          description: "Citadine pratique, économique.",
          image: "imagesvoitures/voiture1.jpeg",
        },
        {
          name: "Voiture 2 boîte manuelle",
          description: "Berline spacieuse pour les trajets longs.",
          image: "imagesvoitures/voiture2.jpeg",
        },
        {
          name: "Voiture 3 boîte automatique",
          description: "SUV tout confort, idéal famille.",
          image: "imagesvoitures/voiture3.jpeg",
        },
        {
          name: "Voiture 4 boîte automatique",
          description: "Sportive moderne et élégante.",
          image: "imagesvoitures/voiture4.jpeg",
        },
      ];
    }
    renderProducts();
    renderSlider();
    showSlide(0);
  }

  function renderProducts() {
    productList.innerHTML = "";
    products.forEach((prod, i) => {
      const el = createProductElement(prod, i);
      productList.appendChild(el);
    });
  }

  function renderSlider() {
    slideTrack.innerHTML = "";
    products.forEach((prod) => {
      const img = document.createElement("img");
      img.src = prod.image;
      img.alt = prod.name;
      img.onerror = () => {
        img.src = "imagesvoitures/fallback.png";
      };
      slideTrack.appendChild(img);
    });
  }

  let index = 0;

  function showSlide(i) {
    if (products.length === 0) {
      slideCaption.textContent = "Aucun produit disponible";
      slideTrack.style.transform = "translateX(0)";
      return;
    }
    index = (i + products.length) % products.length;
    slideTrack.style.transform = `translateX(-${index * 100}%)`;
    slideCaption.innerHTML = `<strong>${products[index].name}</strong><br>${products[index].description}`;
  }

  function nextSlide() {
    showSlide(index + 1);
  }

  function prevSlide() {
    showSlide(index - 1);
  }

  setInterval(nextSlide, 10000);
  loadProducts();
</script>
</body>
</html>
